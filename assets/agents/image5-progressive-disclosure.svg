<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 800 440">
  <style>text{font-family:"Helvetica Neue",Helvetica,Arial,sans-serif}</style>

  <!-- ═══════════ LEFT: STATE (persistent storage) ═══════════ -->
  <text x="110" y="22" text-anchor="middle" font-size="11" font-weight="700" fill="#111">STATE</text>
  <text x="110" y="35" text-anchor="middle" font-size="9" fill="#999">Persistent storage</text>

  <!-- State container -->
  <rect x="20" y="48" width="180" height="370" rx="6" fill="#fafafa" stroke="#ccc" stroke-width="1"/>

  <!-- Context files -->
  <rect x="36" y="64" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="82" text-anchor="middle" font-size="9" font-weight="600" fill="#111">project-overview.md</text>

  <rect x="36" y="100" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="118" text-anchor="middle" font-size="9" font-weight="600" fill="#111">api-schema.json</text>

  <rect x="36" y="136" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="154" text-anchor="middle" font-size="9" font-weight="600" fill="#111">auth-module.py</text>

  <rect x="36" y="172" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="190" text-anchor="middle" font-size="9" font-weight="600" fill="#111">database-models.py</text>

  <rect x="36" y="208" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="226" text-anchor="middle" font-size="9" font-weight="600" fill="#111">test-results.log</text>

  <rect x="36" y="244" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="262" text-anchor="middle" font-size="9" font-weight="600" fill="#111">config.yaml</text>

  <rect x="36" y="280" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="298" text-anchor="middle" font-size="9" font-weight="600" fill="#111">deploy-notes.md</text>

  <rect x="36" y="316" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="334" text-anchor="middle" font-size="9" font-weight="600" fill="#111">error-handlers.py</text>

  <rect x="36" y="352" width="148" height="28" rx="3" fill="#f7f7f7" stroke="#111" stroke-width="1"/>
  <text x="110" y="370" text-anchor="middle" font-size="9" font-weight="600" fill="#111">migrations/</text>

  <text x="110" y="404" text-anchor="middle" font-size="10" fill="#999">...</text>

  <!-- ═══════════ CENTER: TOOL STEPS (progressive disclosure) ═══════════ -->

  <!-- Step 1: ls — discover what exists -->
  <rect x="250" y="54" width="110" height="44" rx="3" fill="#e8e8e8" stroke="#111" stroke-width="1.2" stroke-dasharray="3 2"/>
  <text x="305" y="73" text-anchor="middle" font-size="13" font-weight="700" fill="#111" font-family="'SF Mono',Monaco,monospace">ls</text>
  <text x="305" y="89" text-anchor="middle" font-size="8" fill="#666">Discover what exists</text>

  <!-- Arrow: State → ls -->
  <line x1="200" y1="76" x2="248" y2="76" stroke="#111" stroke-width="1.2"/>
  <polygon points="246,72 254,76 246,80" fill="#111"/>

  <!-- Arrow: ls → right (result) -->
  <line x1="362" y1="76" x2="410" y2="76" stroke="#111" stroke-width="1.2"/>
  <polygon points="408,72 416,76 408,80" fill="#111"/>

  <!-- ls result snippet -->
  <rect x="416" y="56" width="170" height="40" rx="3" fill="#fff" stroke="#ddd" stroke-width="1"/>
  <text x="424" y="70" font-size="8" fill="#666" font-family="'SF Mono',Monaco,monospace">project-overview.md</text>
  <text x="424" y="80" font-size="8" fill="#666" font-family="'SF Mono',Monaco,monospace">api-schema.json auth-module.py</text>
  <text x="424" y="90" font-size="8" fill="#666" font-family="'SF Mono',Monaco,monospace">database-models.py config.yaml ...</text>

  <!-- Step label -->
  <circle cx="232" cy="76" r="10" fill="#111"/>
  <text x="232" y="80" text-anchor="middle" font-size="9" font-weight="700" fill="#fff">1</text>

  <!-- Step 2: grep — search for relevance -->
  <rect x="250" y="160" width="110" height="44" rx="3" fill="#e8e8e8" stroke="#111" stroke-width="1.2" stroke-dasharray="3 2"/>
  <text x="305" y="179" text-anchor="middle" font-size="13" font-weight="700" fill="#111" font-family="'SF Mono',Monaco,monospace">grep</text>
  <text x="305" y="195" text-anchor="middle" font-size="8" fill="#666">Search for relevance</text>

  <!-- Arrow: State → grep -->
  <line x1="200" y1="182" x2="248" y2="182" stroke="#111" stroke-width="1.2"/>
  <polygon points="246,178 254,182 246,186" fill="#111"/>

  <!-- Arrow: grep → right (result) -->
  <line x1="362" y1="182" x2="410" y2="182" stroke="#111" stroke-width="1.2"/>
  <polygon points="408,178 416,182 408,186" fill="#111"/>

  <!-- grep result snippet -->
  <rect x="416" y="158" width="170" height="48" rx="3" fill="#fff" stroke="#ddd" stroke-width="1"/>
  <text x="424" y="172" font-size="8" fill="#666" font-family="'SF Mono',Monaco,monospace">auth-module.py:23</text>
  <text x="424" y="182" font-size="8" fill="#111" font-weight="600" font-family="'SF Mono',Monaco,monospace">  def validate_token(tok):</text>
  <text x="424" y="192" font-size="8" fill="#666" font-family="'SF Mono',Monaco,monospace">auth-module.py:47</text>
  <text x="424" y="202" font-size="8" fill="#111" font-weight="600" font-family="'SF Mono',Monaco,monospace">  def refresh_token(user):</text>

  <!-- Step label -->
  <circle cx="232" cy="182" r="10" fill="#111"/>
  <text x="232" y="186" text-anchor="middle" font-size="9" font-weight="700" fill="#fff">2</text>

  <!-- Vertical connector 1→2 -->
  <line x1="305" y1="98" x2="305" y2="160" stroke="#bbb" stroke-width="1" stroke-dasharray="4 3"/>

  <!-- Step 3: cat — read the detail -->
  <rect x="250" y="270" width="110" height="44" rx="3" fill="#e8e8e8" stroke="#111" stroke-width="1.2" stroke-dasharray="3 2"/>
  <text x="305" y="289" text-anchor="middle" font-size="13" font-weight="700" fill="#111" font-family="'SF Mono',Monaco,monospace">cat</text>
  <text x="305" y="305" text-anchor="middle" font-size="8" fill="#666">Read the detail</text>

  <!-- Arrow: State → cat (highlight the specific file) -->
  <line x1="184" y1="150" x2="208" y2="150" stroke="#111" stroke-width="1.2"/>
  <line x1="208" y1="150" x2="208" y2="292" stroke="#111" stroke-width="1.2"/>
  <line x1="208" y1="292" x2="248" y2="292" stroke="#111" stroke-width="1.2"/>
  <polygon points="246,288 254,292 246,296" fill="#111"/>

  <!-- Highlight the auth-module.py file in state -->
  <rect x="36" y="136" width="148" height="28" rx="3" fill="#e8e8e8" stroke="#111" stroke-width="2"/>
  <text x="110" y="154" text-anchor="middle" font-size="9" font-weight="700" fill="#111">auth-module.py</text>

  <!-- Arrow: cat → right (full content) -->
  <line x1="362" y1="292" x2="410" y2="292" stroke="#111" stroke-width="1.2"/>
  <polygon points="408,288 416,292 408,296" fill="#111"/>

  <!-- cat result snippet -->
  <rect x="416" y="260" width="170" height="64" rx="3" fill="#fff" stroke="#ddd" stroke-width="1"/>
  <text x="424" y="274" font-size="8" fill="#999" font-family="'SF Mono',Monaco,monospace">21  class AuthManager:</text>
  <text x="424" y="284" font-size="8" fill="#999" font-family="'SF Mono',Monaco,monospace">22    """Token lifecycle."""</text>
  <text x="424" y="294" font-size="8" fill="#111" font-weight="600" font-family="'SF Mono',Monaco,monospace">23    def validate_token(...):</text>
  <text x="424" y="304" font-size="8" fill="#111" font-family="'SF Mono',Monaco,monospace">24      if tok.expired:</text>
  <text x="424" y="314" font-size="8" fill="#111" font-family="'SF Mono',Monaco,monospace">25        raise AuthError()</text>

  <!-- Step label -->
  <circle cx="232" cy="292" r="10" fill="#111"/>
  <text x="232" y="296" text-anchor="middle" font-size="9" font-weight="700" fill="#fff">3</text>

  <!-- Vertical connector 2→3 -->
  <line x1="305" y1="204" x2="305" y2="270" stroke="#bbb" stroke-width="1" stroke-dasharray="4 3"/>

  <!-- ═══════════ RIGHT: WORKING MEMORY ═══════════ -->
  <text x="700" y="22" text-anchor="middle" font-size="11" font-weight="700" fill="#111">WORKING MEMORY</text>
  <text x="700" y="35" text-anchor="middle" font-size="9" fill="#999">Context window</text>

  <!-- Working memory container -->
  <rect x="620" y="48" width="160" height="370" rx="6" fill="#fff" stroke="#111" stroke-width="2"/>

  <!-- Directives (invariant) -->
  <rect x="630" y="58" width="140" height="30" rx="2" fill="#f0f0f0" stroke="#bbb" stroke-width="1"/>
  <text x="700" y="77" text-anchor="middle" font-size="8" font-weight="600" fill="#888">DIRECTIVES (invariant)</text>

  <!-- Tool definitions (invariant) -->
  <rect x="630" y="96" width="140" height="24" rx="2" fill="#f0f0f0" stroke="#bbb" stroke-width="1"/>
  <text x="700" y="112" text-anchor="middle" font-size="8" font-weight="600" fill="#888">TOOL DEFINITIONS</text>

  <!-- Separator -->
  <line x1="636" y1="130" x2="764" y2="130" stroke="#ddd" stroke-width="0.5"/>

  <!-- Loaded state — this is what gets filled in -->
  <text x="636" y="146" font-size="7" font-weight="600" fill="#999">LOADED STATE (semi-stable)</text>

  <!-- Step 1 result enters working memory -->
  <rect x="636" y="154" width="128" height="24" rx="2" fill="#f7f7f7" stroke="#ccc" stroke-width="1"/>
  <text x="642" y="168" font-size="7" fill="#666" font-family="'SF Mono',Monaco,monospace">ls: 9 files, 1 dir</text>

  <!-- Arrow: ls result → working memory -->
  <path d="M 586 76 C 604 76, 604 166, 620 166" stroke="#111" stroke-width="1" fill="none"/>
  <polygon points="618,162 626,166 618,170" fill="#111"/>

  <!-- Step 2 result enters working memory -->
  <rect x="636" y="184" width="128" height="32" rx="2" fill="#f7f7f7" stroke="#ccc" stroke-width="1"/>
  <text x="642" y="196" font-size="7" fill="#666" font-family="'SF Mono',Monaco,monospace">grep: 2 matches in</text>
  <text x="642" y="207" font-size="7" fill="#111" font-weight="600" font-family="'SF Mono',Monaco,monospace">auth-module.py:23,47</text>

  <!-- Arrow: grep result → working memory -->
  <path d="M 586 182 C 604 182, 604 200, 620 200" stroke="#111" stroke-width="1" fill="none"/>
  <polygon points="618,196 626,200 618,204" fill="#111"/>

  <!-- Step 3 result enters working memory -->
  <rect x="636" y="222" width="128" height="56" rx="2" fill="#fff" stroke="#111" stroke-width="1.5"/>
  <text x="642" y="235" font-size="7" fill="#999" font-family="'SF Mono',Monaco,monospace">auth-module.py (full)</text>
  <text x="642" y="247" font-size="7" fill="#111" font-family="'SF Mono',Monaco,monospace">class AuthManager:</text>
  <text x="642" y="257" font-size="7" fill="#111" font-family="'SF Mono',Monaco,monospace">  def validate_token</text>
  <text x="642" y="267" font-size="7" fill="#111" font-family="'SF Mono',Monaco,monospace">  def refresh_token</text>
  <text x="642" y="277" font-size="7" fill="#999" font-family="'SF Mono',Monaco,monospace">  ...</text>

  <!-- Arrow: cat result → working memory -->
  <path d="M 586 292 C 604 292, 604 252, 620 252" stroke="#111" stroke-width="1.2" fill="none"/>
  <polygon points="618,248 626,252 618,256" fill="#111"/>

  <!-- Separator -->
  <line x1="636" y1="290" x2="764" y2="290" stroke="#ddd" stroke-width="0.5"/>

  <!-- Conversation history (volatile) -->
  <text x="636" y="306" font-size="7" font-weight="600" fill="#999">CONVERSATION (volatile)</text>
  <rect x="636" y="312" width="128" height="20" rx="2" fill="#fff" stroke="#ddd" stroke-width="0.8"/>
  <text x="642" y="326" font-size="7" fill="#888">"Fix the token validation bug"</text>
  <rect x="636" y="336" width="128" height="20" rx="2" fill="#fff" stroke="#ddd" stroke-width="0.8"/>
  <text x="642" y="350" font-size="7" fill="#888">Agent: searching for auth...</text>

  <!-- Capacity indicator -->
  <rect x="636" y="364" width="128" height="44" rx="2" fill="none" stroke="#e0e0e0" stroke-width="0.8" stroke-dasharray="3 2"/>
  <text x="700" y="390" text-anchor="middle" font-size="8" fill="#ccc">(remaining capacity)</text>

  <!-- ═══════════ ANNOTATIONS ═══════════ -->

  <!-- Information density annotation -->
  <text x="305" y="356" text-anchor="middle" font-size="9" font-style="italic" fill="#999">Each step loads more detail, less breadth</text>

  <!-- Bracket showing progressive narrowing -->
  <text x="305" y="380" text-anchor="middle" font-size="9" fill="#999">File list → Line matches → Full content</text>

  <!-- Agent decision arrows (dashed, showing agent chooses next step) -->
  <text x="500" y="124" text-anchor="middle" font-size="7" font-style="italic" fill="#999">Agent decides:</text>
  <text x="500" y="134" text-anchor="middle" font-size="7" font-style="italic" fill="#999">"search for token logic"</text>

  <text x="500" y="234" text-anchor="middle" font-size="7" font-style="italic" fill="#999">Agent decides:</text>
  <text x="500" y="244" text-anchor="middle" font-size="7" font-style="italic" fill="#999">"read full auth module"</text>
</svg>
